<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
{% extends "templates/web.html" %}

{% block title %} {{ title }} {% endblock %}

{% block header %}<h3 class="partners_head">Find Dexciss Partner</h3>{% endblock %}


{% block page_content %}
</head>

<style>
body{
    margin:0;
    padding:0;
    font-family: Inter,ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji" !important;
}   
	.partners_head{
		margin-left:12rem;
        margin-top: 0;
        top:0;
        padding-bottom: 5%;
        font-family: Roboto;
	}
    #search-container {
        display: flex;
        justify-content: space-between;
        align-items: center;
        width: 66%;
        margin: 0 auto;
        margin-bottom: 20px;
    }
	select::placeholder{
		font-size:12px;
	}
	input::placeholder{
		font-size: 12px;

	}
	option{
		font-size: 12px;
	}

    .search-input,
    .search-dropdown {
		height: 30px;
    width: 20%;
        margin-right: 10px;
        padding: 5px;
        border: none;
        border-radius: 5px;
		font-size: 12px;
        background: #F3F3F3;
    }

    
    .search-dropdown::placeholder{
        font-weight: lighter;
    }

    @media only screen and (max-width: 768px) {
        #search-container {
            flex-direction: column;
            align-items: stretch;
            margin:0;

        }

        .search-input,
        .search-dropdown {
            width: 60%;
            margin: 5px 0;
        }

        .verified-checkbox {
    
    position: absolute;
    top: 8px;
    right: 11px;
    object-fit: contain;
    color: white;
    border: none;
    /* padding: 5px; */
    width: 23%;
    height: 25%;
}
    }

    #partners-content {
       
        width: 66%;
        margin: 0 auto;
        padding: 0;
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(24%, 1fr)); /* Adjust column width for responsiveness */
        gap: 2%;
		margin-top: 3%;
    }

	.details {
    position: relative;
    border-radius: 10px;
    border: 1px solid rgb(243 243 243);
 
    margin-bottom: 10px;
    padding: 10px;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    cursor: pointer;
}

.partner-logo {
    width: 40%; 
    height: 45%; 
    align-self: flex-start;
    object-fit: contain;
}

.partner-name {
    font-weight: bold;
    width: 100%;
    display: block;
    align-self: flex-start;
	margin-top:5%;
    font-size: 14px;
}

.verified-checkbox {
    
    position: absolute;
    top: 8px;
    right: 11px;
    object-fit: contain;
    color: white;
    border: none;
    /* padding: 5px; */
    width: 16%;
    height: 23%;
}
.verified-checkbox > img{
    width:100%;
    height:100%;
    object-fit: contain;
}



.territory {
	align-self: flex-start;
    color: gray;
    font-size: 12px;
    margin-top: 4%;
    margin-left: 2%;
    margin-bottom: -4%;
}






    @media only screen and (max-width: 768px) {
         #partners-content {
            grid-template-columns: repeat(1, 1fr);
    margin: 0%;
    padding: 5% 0% 0% 0%;
    width:100%;
        }
        .partners_head{
		    margin: 0rem;
    /* margin-top: 0; */
    /* top: 0; */
    /* text-align: center; */
    padding-bottom: 5%;
    font-family: Roboto;
	} 
    #pagination{
        display: flex;
    justify-content: flex-start;
    margin-top: 8%;
}

.details {
    position: relative;
    border-radius: 10px;
    border: 1px solid rgb(243 243 243);
 
 
    padding: 10px;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    cursor: pointer;
    width: 154%;
    margin: 0% 0% -4% 0%;
   
}


#partners-content {
        display: flex;
        flex-direction: column;
        align-items: center; 
        width:100%;
    }

    .details {
        width: calc(100% - 20px);  
        height: 200px; 
        margin: 10px 0; 
    }

.verified-checkbox {
    
    position: absolute;
    top: 8px;
    right: 11px;
    object-fit: contain;
    color: white;
    border: none;
    /* padding: 5px; */
    width: 23%;
    height: 25%;
}
    
    } 



	.pagination {
        margin-top: 20px;
        display: flex;
        justify-content: center;
        flex-wrap: wrap; /* Allow pagination buttons to wrap on small screens */
    }

    .pagination button {
        margin: 5px;
        padding: 5px 10px;
        background-color: #f0f0f0;
        border: 1px solid #ccc;
        border-radius: 5px;
        cursor: pointer;
        font-family: Roboto;
        font-size: 14px;
    }


    /* Define a specific class for Safari browser */
@media not all and (min-resolution:.001dpcm) { 
  @supports (-webkit-appearance:none) { 
    #partners-content {
            grid-template-columns: repeat(1, 1fr);
    margin: 0%;
    padding: 5% 0% 0% 0%;
    width:100%;
        }
        .partners_head{
		    margin: 0rem;
   
    padding-bottom: 5%;
    font-family: Roboto;
	} 
    #pagination{
        display: flex;
    justify-content: flex-start;
    margin-top: 8%;
}

.details {
    position: relative;
    border-radius: 10px;
    border: 1px solid rgb(243 243 243);
 
 
    padding: 10px;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    cursor: pointer;
    width: 154%;
    margin: 0% 0% -4% 0%;
   
}


#partners-content {
        display: flex;
        flex-direction: column;
        align-items: center; 
        width:100%;
    }

    .details {
        width: calc(100% - 20px);  
        height: 200px; 
        margin: 10px 0; 
    }

.verified-checkbox {
    
    position: absolute;
    top: 8px;
    right: 11px;
    object-fit: contain;
    color: white;
    border: none;
    /* padding: 5px; */
    width: 23%;
    height: 25%;
}
  }
    
}

</style>
<body>
<div id="search-container">
    <input type="text" class="search-input" placeholder="Name">
    <!-- <input type="text" class="search-input" placeholder="Partner Type"> -->
    <select class="search-input" id="listDropdown" placeholder="Partner Type">
        <option value="">All Partner Types</option>
      

    </select>
    <!-- <select class="search-dropdown" aria-placeholder="Certified Partners">
        <option value="">Partners</option>
        <option value="certified partners">Certified Partners</option>
        <option value="non certified partners">Non certified Partners</option>


       
    </select> -->

    <select class="search-input" id="domainDropdown" placeholder="Partner Type">
        <option value="">All Domains</option>
      

    </select>
    <select class="search-dropdown" id="countryDropdown">
        <option value="">All Countries</option>
    </select>
    
    <select class="search-dropdown" aria-placeholder="Certified Partners">
        <option value="">All Partners</option>
        <option value="certified partners">Certified Partners</option>
        <option value="non certified partners">Non certified Partners</option>


       
    </select>
</div>

<div id="partners-content" class="partners-content">
    <!-- <img src="./img/verified.jpeg" /> -->
  
</div>

<div class="pagination" id="pagination">
    <button id="prevBtn" disabled>Prev</button>
    
    <button id="nextBtn">Next</button>
</div>


<script>


const countries = [  "India", "Tanzania", "Saudi Arabia", "Indonesia", "Egypt", "United States", "East India", "United Arab Emirates", "Libya", "Uganda", "United Kingdom", "Iraq", "Kenya", "Germeny", "Philippines",
        "Afghanistan", "Albania", "Algeria", "Andorra", "Angola", "Antigua and Barbuda", "Argentina", "Armenia",
        
    ];




    const countryEmojis = {
    "Afghanistan": "ğŸ‡¦ğŸ‡«",
    "Albania": "ğŸ‡¦ğŸ‡±",
    "Algeria": "ğŸ‡©ğŸ‡¿",
    "Andorra": "ğŸ‡¦ğŸ‡©",
    "Angola": "ğŸ‡¦ğŸ‡´",
    "Antigua and Barbuda": "ğŸ‡¦ğŸ‡¬",
    "Argentina": "ğŸ‡¦ğŸ‡·",
    "Armenia": "ğŸ‡¦ğŸ‡²",
    "Australia": "ğŸ‡¦ğŸ‡º",
    "Austria": "ğŸ‡¦ğŸ‡¹",
    "Azerbaijan": "ğŸ‡¦ğŸ‡¿",
    "Bahamas": "ğŸ‡§ğŸ‡¸",
    "Bahrain": "ğŸ‡§ğŸ‡­",
    "Bangladesh": "ğŸ‡§ğŸ‡©",
    "Barbados": "ğŸ‡§ğŸ‡§",
    "Belarus": "ğŸ‡§ğŸ‡¾",
    "Belgium": "ğŸ‡§ğŸ‡ª",
    "Belize": "ğŸ‡§ğŸ‡¿",
    "Benin": "ğŸ‡§ğŸ‡¯",
    "Bhutan": "ğŸ‡§ğŸ‡¹",
    "Bolivia": "ğŸ‡§ğŸ‡´",
    "Bosnia and Herzegovina": "ğŸ‡§ğŸ‡¦",
    "Botswana": "ğŸ‡§ğŸ‡¼",
    "Brazil": "ğŸ‡§ğŸ‡·",
    "Brunei": "ğŸ‡§ğŸ‡³",
    "Bulgaria": "ğŸ‡§ğŸ‡¬",
    "Burkina Faso": "ğŸ‡§ğŸ‡«",
    "Burundi": "ğŸ‡§ğŸ‡®",
    "Cabo Verde": "ğŸ‡¨ğŸ‡»",
    "Cambodia": "ğŸ‡°ğŸ‡­",
    "Cameroon": "ğŸ‡¨ğŸ‡²",
    "Canada": "ğŸ‡¨ğŸ‡¦",
    "Central African Republic": "ğŸ‡¨ğŸ‡«",
    "Chad": "ğŸ‡¹ğŸ‡©",
    "Chile": "ğŸ‡¨ğŸ‡±",
    "China": "ğŸ‡¨ğŸ‡³",
    "Colombia": "ğŸ‡¨ğŸ‡´",
    "Comoros": "ğŸ‡°ğŸ‡²",
    "Congo": "ğŸ‡¨ğŸ‡¬",
    "Costa Rica": "ğŸ‡¨ğŸ‡·",
    "Croatia": "ğŸ‡­ğŸ‡·",
    "Cuba": "ğŸ‡¨ğŸ‡º",
    "Cyprus": "ğŸ‡¨ğŸ‡¾",
    "Czech Republic": "ğŸ‡¨ğŸ‡¿",
    "Denmark": "ğŸ‡©ğŸ‡°",
    "Djibouti": "ğŸ‡©ğŸ‡¯",
    "Dominica": "ğŸ‡©ğŸ‡²",
    "Dominican Republic": "ğŸ‡©ğŸ‡´",
     "East India": "ğŸ‡ªğŸ‡¨",
    "Ecuador": "ğŸ‡ªğŸ‡¨",
    "Egypt": "ğŸ‡ªğŸ‡¬",
    "El Salvador": "ğŸ‡¸ğŸ‡»",
    "Equatorial Guinea": "ğŸ‡¬ğŸ‡¶",
    "Eritrea": "ğŸ‡ªğŸ‡·",
    "Estonia": "ğŸ‡ªğŸ‡ª",
    "Eswatini": "ğŸ‡¸ğŸ‡¿",
    "Ethiopia": "ğŸ‡ªğŸ‡¹",
    "Fiji": "ğŸ‡«ğŸ‡¯",
    "Finland": "ğŸ‡«ğŸ‡®",
    "France": "ğŸ‡«ğŸ‡·",
    "Gabon": "ğŸ‡¬ğŸ‡¦",
    "Gambia": "ğŸ‡¬ğŸ‡²",
    "Georgia": "ğŸ‡¬ğŸ‡ª",
    "Germany": "ğŸ‡©ğŸ‡ª",
    "Ghana": "ğŸ‡¬ğŸ‡­",
    "Greece": "ğŸ‡¬ğŸ‡·",
    "Grenada": "ğŸ‡¬ğŸ‡©",
    "Guatemala": "ğŸ‡¬ğŸ‡¹",
    "Guinea": "ğŸ‡¬ğŸ‡³",
    "Guinea-Bissau": "ğŸ‡¬ğŸ‡¼",
    "Guyana": "ğŸ‡¬ğŸ‡¾",
    "Haiti": "ğŸ‡­ğŸ‡¹",
    "Honduras": "ğŸ‡­ğŸ‡³",
    "Hungary": "ğŸ‡­ğŸ‡º",
    "Iceland": "ğŸ‡®ğŸ‡¸",
    "India": "ğŸ‡®ğŸ‡³",
    "Indonesia": "ğŸ‡®ğŸ‡©",
    "Iran": "ğŸ‡®ğŸ‡·",
    "Iraq": "ğŸ‡®ğŸ‡¶",
    "Ireland": "ğŸ‡®ğŸ‡ª",
    "Israel": "ğŸ‡®ğŸ‡±",
    "Italy": "ğŸ‡®ğŸ‡¹",
    "Jamaica": "ğŸ‡¯ğŸ‡²",
    "Japan": "ğŸ‡¯ğŸ‡µ",
    "Jordan": "ğŸ‡¯ğŸ‡´",
    "Kazakhstan": "ğŸ‡°ğŸ‡¿",
    "Kenya": "ğŸ‡°ğŸ‡ª",
    "Kiribati": "ğŸ‡°ğŸ‡®",
    "Kuwait": "ğŸ‡°ğŸ‡¼",
    "Kyrgyzstan": "ğŸ‡°ğŸ‡¬",
    "Laos": "ğŸ‡±ğŸ‡¦",
    "Latvia": "ğŸ‡±ğŸ‡»",
    "Lebanon": "ğŸ‡±ğŸ‡§",
    "Lesotho": "ğŸ‡±ğŸ‡¸",
    "Liberia": "ğŸ‡±ğŸ‡·",
    "Libya": "ğŸ‡±ğŸ‡¾",
    "Liechtenstein": "ğŸ‡±ğŸ‡®",
    "Lithuania": "ğŸ‡±ğŸ‡¹",
    "Luxembourg": "ğŸ‡±ğŸ‡º",
    "Madagascar": "ğŸ‡²ğŸ‡¬",
    "Malawi": "ğŸ‡²ğŸ‡¼",
    "Malaysia": "ğŸ‡²ğŸ‡¾",
    "Maldives": "ğŸ‡²ğŸ‡»",
    "Mali": "ğŸ‡²ğŸ‡±",
    "Malta": "ğŸ‡²ğŸ‡¹",
    "Marshall Islands": "ğŸ‡²ğŸ‡­",
    "Mauritania": "ğŸ‡²ğŸ‡·",
    "Mauritius": "ğŸ‡²ğŸ‡º",
    "Mexico": "ğŸ‡²ğŸ‡½",
    "Micronesia": "ğŸ‡«ğŸ‡²",
    "Moldova": "ğŸ‡²ğŸ‡©",
    "Monaco": "ğŸ‡²ğŸ‡¨",
    "Mongolia": "ğŸ‡²ğŸ‡³",
    "Montenegro": "ğŸ‡²ğŸ‡ª",
    "Morocco": "ğŸ‡²ğŸ‡¦",
    "Mozambique": "ğŸ‡²ğŸ‡¿",
    "Myanmar": "ğŸ‡²ğŸ‡²",
    "Namibia": "ğŸ‡³ğŸ‡¦",
    "Nauru": "ğŸ‡³ğŸ‡·",
    "Nepal": "ğŸ‡³ğŸ‡µ",
    "Netherlands": "ğŸ‡³ğŸ‡±",
    "New Zealand": "ğŸ‡³ğŸ‡¿",
    "Nicaragua": "ğŸ‡³ğŸ‡®",
    "Niger": "ğŸ‡³ğŸ‡ª",
    "Nigeria": "ğŸ‡³ğŸ‡¬",
    "North Korea": "ğŸ‡°ğŸ‡µ",
    "North Macedonia": "ğŸ‡²ğŸ‡°",
    "Norway": "ğŸ‡³ğŸ‡´",
    "Oman": "ğŸ‡´ğŸ‡²",
    "Pakistan": "ğŸ‡µğŸ‡°",
    "Palau": "ğŸ‡µğŸ‡¼",
    "Palestine": "ğŸ‡µğŸ‡¸",
    "Panama": "ğŸ‡µğŸ‡¦",
    "Papua New Guinea": "ğŸ‡µğŸ‡¬",
    "Paraguay": "ğŸ‡µğŸ‡¾",
    "Peru": "ğŸ‡µğŸ‡ª",
    "Philippines": "ğŸ‡µğŸ‡­",
    "Poland": "ğŸ‡µğŸ‡±",
    "Portugal": "ğŸ‡µğŸ‡¹",
    "Qatar": "ğŸ‡¶ğŸ‡¦",
    "Romania": "ğŸ‡·ğŸ‡´",
    "Russia": "ğŸ‡·ğŸ‡º",
    "Rwanda": "ğŸ‡·ğŸ‡¼",
    "Saint Kitts and Nevis": "ğŸ‡°ğŸ‡³",
    "Saint Lucia": "ğŸ‡±ğŸ‡¨",
    "Saint Vincent and the Grenadines": "ğŸ‡»ğŸ‡¨",
    "Samoa": "ğŸ‡¼ğŸ‡¸",
    "San Marino": "ğŸ‡¸ğŸ‡²",
    "Sao Tome and Principe": "ğŸ‡¸ğŸ‡¹",
    "Saudi Arabia": "ğŸ‡¸ğŸ‡¦",
    "Senegal": "ğŸ‡¸ğŸ‡³",
    "Serbia": "ğŸ‡·ğŸ‡¸",
    "Seychelles": "ğŸ‡¸ğŸ‡¨",
    "Sierra Leone": "ğŸ‡¸ğŸ‡±",
    "Singapore": "ğŸ‡¸ğŸ‡¬",
    "Slovakia": "ğŸ‡¸ğŸ‡°",
    "Slovenia": "ğŸ‡¸ğŸ‡®",
    "Solomon Islands": "ğŸ‡¸ğŸ‡§",
    "Somalia": "ğŸ‡¸ğŸ‡´",
    "South Africa": "ğŸ‡¿ğŸ‡¦",
    "South Korea": "ğŸ‡°ğŸ‡·",
    "South Sudan": "ğŸ‡¸ğŸ‡¸",
    "Spain": "ğŸ‡ªğŸ‡¸",
    "Sri Lanka": "ğŸ‡±ğŸ‡°",
    "Sudan": "ğŸ‡¸ğŸ‡©",
    "Suriname": "ğŸ‡¸ğŸ‡·",
    "Sweden": "ğŸ‡¸ğŸ‡ª",
    "Switzerland": "ğŸ‡¨ğŸ‡­",
    "Syria": "ğŸ‡¸ğŸ‡¾",
    "Tajikistan": "ğŸ‡¹ğŸ‡¯",
    "Tanzania": "ğŸ‡¹ğŸ‡¿",
    "Thailand": "ğŸ‡¹ğŸ‡­",
    "Timor-Leste": "ğŸ‡¹ğŸ‡±",
    "Togo": "ğŸ‡¹ğŸ‡¬",
    "Tonga": "ğŸ‡¹ğŸ‡´",
    "Trinidad and Tobago": "ğŸ‡¹ğŸ‡¹",
    "Tunisia": "ğŸ‡¹ğŸ‡³",
    "Turkey": "ğŸ‡¹ğŸ‡·",
    "Turkmenistan": "ğŸ‡¹ğŸ‡²",
    "Tuvalu": "ğŸ‡¹ğŸ‡»",
    "Uganda": "ğŸ‡ºğŸ‡¬",
    "Ukraine": "ğŸ‡ºğŸ‡¦",
    "United Arab Emirates": "ğŸ‡¦ğŸ‡ª",
    "United Kingdom": "ğŸ‡¬ğŸ‡§",
    "United States": "ğŸ‡ºğŸ‡¸",
    "Uruguay": "ğŸ‡ºğŸ‡¾",
    "Uzbekistan": "ğŸ‡ºğŸ‡¿",
    "Vanuatu": "ğŸ‡»ğŸ‡º",
    "Vatican City": "ğŸ‡»ğŸ‡¦",
    "Venezuela": "ğŸ‡»ğŸ‡ª",
    "Vietnam": "ğŸ‡»ğŸ‡³",
    "Yemen": "ğŸ‡¾ğŸ‡ª",
    "Zambia": "ğŸ‡¿ğŸ‡²",
    "Zimbabwe": "ğŸ‡¿ğŸ‡¼",
   
};

    const countryDropdown = document.getElementById("countryDropdown");

    countries.forEach(country => {
        const option = document.createElement("option");
        option.value = country;
        option.textContent = country;
        countryDropdown.appendChild(option);
    });


let data_list = []


    const fetch_data = async () => {

        try{
            const sales_list = await fetch('/api/method/nextproject.api.sales_partner_type_list');
            const list_data = await sales_list.json()
            // console.log('list_data', list_data)
            data_list =  list_data.message;
            // console.log('dataaaa', data_list)
            const listDropdown = document.getElementById("listDropdown");

//  listDropdown.innerHTML = '';


data_list.forEach(item => {
    const option = document.createElement("option");
    option.value = item; 
    option.textContent = item; 
    // console.log()
    listDropdown.appendChild(option);
});

        }
        catch(error){
          console.log('errorr', error);
        }
    }

    fetch_data()


    let domain_list = []


    const fetch_domain = async () => {

        try{
            const domainlist = await fetch('/api/method/nextproject.api.sales_partner_domain_list');
            const Ddata = await domainlist.json()
            // console.log('list_data', list_data)
            domain_list =  Ddata.message;
            // console.log('domain', domain_list)
            const listDropdown = document.getElementById("domainDropdown");

//  listDropdown.innerHTML = '';


domain_list.forEach(item => {
    const option = document.createElement("option");
    option.value = item; 
    option.textContent = item; 
    // console.log()
    listDropdown.appendChild(option);
});

        }
        catch(error){
          console.log('errorr', error);
        }
    }

    fetch_domain()
	




	document.addEventListener("DOMContentLoaded", async function() {
    const detailsContainer = document.getElementById("partners-content");
    const searchInputs = document.querySelectorAll(".search-input");
    const searchDropdowns = document.querySelectorAll(".search-dropdown");

    const itemsPerPage = 40;
    let currentPage = 1;

    let partnersData = []; 

    try {
        const response = await fetch("/api/method/nextproject.api.get_all_sales_partner_list");
        const data = await response.json();
        partnersData = data.message; 
        displayPartners(partnersData);
        // console.log('data', partnersData)
    } catch (error) {
        console.error("Error fetching data:", error);
    }

    
    function displayPartners(partners) {
        detailsContainer.innerHTML = ''; 

        partners.forEach(partner => {
            const detailsDiv = createPartnerDetailElement(partner);
            detailsContainer.appendChild(detailsDiv);
        });
    }

   
    function createPartnerDetailElement(partner) {
    const detailsDiv = document.createElement("div");
    detailsDiv.classList.add("details");
    

    const logoImg = document.createElement("img");
    logoImg.src = partner.logo;
    logoImg.alt = partner.partner_name;
    logoImg.classList.add("partner-logo");
    detailsDiv.appendChild(logoImg);

    const partnerNameSpan = document.createElement("span");
    partnerNameSpan.textContent = decodeURIComponent(partner.partner_name);
    partnerNameSpan.classList.add("partner-name");
    detailsDiv.appendChild(partnerNameSpan);

    if (partner.custom_certified_partner === 1) {
        const verifiedCheckbox = document.createElement("img");
        verifiedCheckbox.src = "/assets/nextproject/images/verified.jpeg"; 
        verifiedCheckbox.alt = "."
        verifiedCheckbox.classList.add("verified-checkbox");
        detailsDiv.appendChild(verifiedCheckbox);
    }
   

    const territorySpan = document.createElement("span");
    territorySpan.textContent = `${partner.territory}`;
    territorySpan.classList.add("territory");
    // Set emoji flag based on country
   if (countryEmojis[partner.territory]) {
    territorySpan.textContent = countryEmojis[partner.territory] + ' ' + territorySpan.textContent;
}

    detailsDiv.appendChild(territorySpan);

    detailsDiv.addEventListener("click", () => {
        redirectToPartnerDetailsPage(partner.partner_name);
    });

    return detailsDiv;
}


   



    function redirectToPartnerDetailsPage(partnerName) {
        window.location.href = `/partner-details?name=${encodeURIComponent(partnerName)}`;
    }




    
    function filterPartners() {
        const searchText = searchInputs[0].value.toLowerCase();
        const partnerType = searchInputs[1].value.toLowerCase();
        const domainType = searchInputs[2].value.toLowerCase();

        const country = searchDropdowns[0].value.toLowerCase();
        const partnerStatus = searchDropdowns[1].value.toLowerCase();
        // const certifiedStatus = searchDropdowns[2].value.toLowerCase(); 

        const filteredPartners = partnersData.filter(partner => {
            const partnerName = decodeURIComponent(partner.partner_name).toLowerCase();
            const typeMatch = partnerType === '' || partner.partner_type.toLowerCase().includes(partnerType);
            const domainMatch = domainType === '' || partner.custom_domain.some(domain => domain.toLowerCase().includes(domainType));

            const countryMatch = country === '' || partner.territory.toLowerCase() === country;
            const statusMatch = partnerStatus === '' ||
                (partnerStatus === 'certified partners' && partner.custom_certified_partner === 1) ||
                (partnerStatus === 'non certified partners' && partner.custom_certified_partner !== 1);
           

            return partnerName.includes(searchText) && typeMatch && domainMatch && countryMatch && statusMatch; 
        });

        displayPartners(filteredPartners);
        
        
        updateURL(searchText, partnerType, domainType, country, partnerStatus);
    }

  
    function updateURL(searchText, partnerType, domainType, country, partnerStatus) {
        const params = new URLSearchParams();

        if (searchText) params.set('search', searchText);
        if (partnerType) params.set('partnerType', partnerType);
        if(domainType) params.set('domainType', domainType);
        if (country) params.set('country', country);
        if (partnerStatus) params.set('partnerStatus', partnerStatus);
      

        const newURL = `${window.location.pathname}?${params}`;
        window.history.pushState({}, '', newURL);
    }

    
    function applyURLFilters() {
        const params = new URLSearchParams(window.location.search);
        const searchText = params.get('search') || '';
        const partnerType = params.get('partnerType') || '';
        const domainType = params.get('domainType') || '';

        const country = params.get('country') || '';
        const partnerStatus = params.get('partnerStatus') || '';
        

      
        searchInputs[0].value = searchText;
        searchInputs[1].value = partnerType;
        searchInputs[2].value = domainType;

        searchDropdowns[0].value = country;
        searchDropdowns[1].value = partnerStatus;
       

        
        filterPartners();
    }

   
    applyURLFilters();

    
    searchInputs.forEach(input => {
        input.addEventListener('input', filterPartners);
    });

    searchDropdowns.forEach(dropdown => {
        dropdown.addEventListener('change', filterPartners);
    });







    function displayPartners(partners) {
        const startIndex = (currentPage - 1) * itemsPerPage;
        const endIndex = startIndex + itemsPerPage;
        const paginatedPartners = partners.slice(startIndex, endIndex);

        detailsContainer.innerHTML = ''; // Clear existing content

        paginatedPartners.forEach(partner => {
            const detailsDiv = createPartnerDetailElement(partner);
            detailsContainer.appendChild(detailsDiv);
        });

        updatePagination(partners.length);
    }

    function updatePagination(totalItems) {
        const totalPages = Math.ceil(totalItems / itemsPerPage);
        const paginationDiv = document.getElementById("pagination");
        paginationDiv.innerHTML = ''; 



        const prevBtn = document.createElement("button");
        prevBtn.textContent = "Prev";
        prevBtn.addEventListener("click", () => {
            if (currentPage > 1) {
                currentPage--;
                filterPartners();
            }
        });
        paginationDiv.appendChild(prevBtn);




        for (let i = 1; i <= totalPages; i++) {
            const button = document.createElement("button");
            button.textContent = i;
            button.addEventListener("click", () => {
                currentPage = i;
                filterPartners();
            });
            paginationDiv.appendChild(button);
        }


        const nextBtn = document.createElement("button");
        nextBtn.textContent = "Next";
        nextBtn.addEventListener("click", () => {
            if (currentPage < totalPages) {
                currentPage++;
                filterPartners();
            }
        });
        paginationDiv.appendChild(nextBtn);
    }







    
});





   
async function fetchCountryFlags(partners) {
    const countryFlags = {};


    const countryNames = partners.map(partner => partner.territory);

    
    try {
        const response = await fetch(`https://restcountries.com/v3.1/name/${countryNames.join(';')}?fields=name,flags`);
        const countries = await response.json();
        
       
        countries.forEach(country => {
            countryFlags[country.name.common] = country.flags.png;
        });
    } catch (error) {
        console.error("Error fetching country flags:", error);
    }

    return countryFlags;
}









    
    


</script>
</body>
</html>

{% endblock %}
